<!DOCTYPE html>
<html lang="zh-CN">
<head>
    <meta charset="utf-8">
    <title>添加点标记</title>
    <meta http-equiv="Content-Type" content="text/html; charset=utf-8">
    <meta name="viewport" content="initial-scale=1.0, user-scalable=no">
    <meta http-equiv="X-UA-Compatible" content="IE=Edge">
    <style>
    body,
    html,
    #container {
        overflow: hidden;
        width: 100%;
        height: 100%;
        margin: 0;
        font-family: "微软雅黑";
    }
    </style>
    <script src="//api.map.baidu.com/api?type=webgl&v=1.0&ak=F8dt3efLmdQdrVU09t8Iy0SxrsBrPFr9"></script>
</head>
<body>
<input type="file" onchange="impexcel(this)" />
    <div id="container"></div>
</body>
</html>
<script src="https://cdn.bootcss.com/jquery/3.4.1/jquery.js"></script>

<script src="https://cdn.bootcss.com/xlsx/0.12.6/xlsx.full.min.js"></script>
<script>
var map = new BMapGL.Map('container');
map.centerAndZoom(new BMapGL.Point(113.104822, 23.364438), 13);
map.enableScrollWheelZoom(true);
// 创建点标记
var marker1 = new BMapGL.Marker(new BMapGL.Point(113.098543,23.398049));
var marker2 = new BMapGL.Marker(new BMapGL.Point(113.147048, 23.360373));
var marker3 = new BMapGL.Marker(new BMapGL.Point(113.158036, 23.408001));
var marker4 = new BMapGL.Marker(new BMapGL.Point(113.157764, 23.374471));
// 在地图上添加点标记
<!--map.addOverlay(marker1);-->
<!--map.addOverlay(marker2);-->
<!--map.addOverlay(marker3);-->
<!--map.addOverlay(marker4);-->
</script>


<script type="text/javascript">

    var wb;// 读取完成的数据

    // 导入

    function impexcel(obj) {

        if (!obj.files) {

            return;

        }

        var f = obj.files[0];

//新建文件读取

        var reader = new FileReader();

        reader.onload = function(e) {

            var data = e.target.result;

            //将文件读取为二进制字符串

            wb = XLSX.read(data, {type : 'binary'});



console.log(wb.SheetNames[j]);

        // wb.SheetNames[0]是获取Sheets中第一个Sheet的名字

        // wb.Sheets[Sheet名]获取第一个Sheet的数据

            JSON.stringify(XLSX.utils.sheet_to_json(wb.Sheets[wb.SheetNames[j]]));
for(var j=0; j<11;j++){
for (var i=2;i<=wb.Sheets[wb.SheetNames[j]]["!ref"].slice(4);i++){
<!--	console.log(wb.Sheets[wb.SheetNames[j]]["I"+i]["w"]);-->
<!--	console.log(wb.Sheets[wb.SheetNames[j]]["F"+i]["w"]);-->
    if (wb.Sheets[wb.SheetNames[j]]["I"+i] != undefined)
{
    var x = wb.Sheets[wb.SheetNames[j]]["I"+i]["w"].split(',')[0];
	var y = wb.Sheets[wb.SheetNames[j]]["I"+i]["w"].split(',')[1]
	console.log(i)
	console.log(x)
	console.log(y)
	var marker1 = new BMapGL.Marker(new BMapGL.Point(x,y));
	console.log(marker1)
	map.addOverlay(marker1);
}

}
}

        };

        reader.readAsBinaryString(f);

    }

</script>

<!--<!DOCTYPE html>-->

<!--<html>-->

<!--<head>-->

<!--<meta charset="UTF-8">-->

<!--<title>js如何解析Excel文件</title>-->

<!--</head>-->

<!--<body>-->

<!--    <input type="file" onchange="impexcel(this)" />-->

<!--</body>-->

<!--<script src="https://cdn.bootcss.com/jquery/3.4.1/jquery.js"></script>-->

<!--<script src="https://cdn.bootcss.com/xlsx/0.12.6/xlsx.full.min.js"></script>-->

<!--<script type="text/javascript">-->

<!--    var wb;// 读取完成的数据-->

<!--    // 导入-->

<!--    function impexcel(obj) {-->

<!--        if (!obj.files) {-->

<!--            return;-->

<!--        }-->

<!--        var f = obj.files[0];-->

<!--//新建文件读取-->

<!--        var reader = new FileReader();-->

<!--        reader.onload = function(e) {-->

<!--            var data = e.target.result;-->

<!--            //将文件读取为二进制字符串-->

<!--            wb = XLSX.read(data, {type : 'binary'});-->



<!--console.log(wb.SheetNames[0]);-->

<!--        // wb.SheetNames[0]是获取Sheets中第一个Sheet的名字-->

<!--        // wb.Sheets[Sheet名]获取第一个Sheet的数据-->

<!--            JSON.stringify(XLSX.utils.sheet_to_json(wb.Sheets[wb.SheetNames[0]]));-->

<!--for (var i=5;i<10;i++){-->
<!--	console.log(wb.Sheets[wb.SheetNames[0]]['B'+i]["w"]);-->
<!--}-->

<!--        };-->

<!--        reader.readAsBinaryString(f);-->

<!--    }-->

<!--</script>-->

<!--</html>-->